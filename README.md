# Smart School

Smart School is a Flutter application for school management with role-based access (e.g., Admin, Parent, Driver). It integrates with Firebase for authentication and data storage, Geolocator for location services, and Flutter Map for mapping.

> Note: This README was updated on 2026-01-04. Where project details are unknown, TODOs are included for the repository maintainer to complete.

## Table of Contents
- [Overview](#overview)
- [Tech Stack](#tech-stack)
- [Requirements](#requirements)
- [Project Structure](#project-structure)
- [Setup](#setup)
- [Running the App](#running-the-app)
- [Build & Release](#build--release)
- [Environment Variables & Configuration](#environment-variables--configuration)
- [Scripts](#scripts)
- [Testing](#testing)
- [Troubleshooting](#troubleshooting)
- [License](#license)

## Overview
This app initializes Firebase on startup and routes users to a login screen. It includes controllers and screens for admins, parents, and drivers, as well as Firebase-backed services.

- Entry point: `lib/main.dart`
- Initial route/home: `LoginScreen` (`lib/screens/login_screen.dart`)
- Firebase initialization: `Firebase.initializeApp(options: DefaultFirebaseOptions.currentPlatform)` using `lib/services/firebase_options.dart` (generated by FlutterFire).

## Tech Stack
- Language: Dart (Flutter)
- Framework: Flutter (Material 3)
- Package manager: `flutter pub`
- Core dependencies (from `pubspec.yaml`):
  - `firebase_core`, `firebase_auth`, `cloud_firestore`
  - `geolocator`
  - `flutter_map`, `latlong2`
  - `http`, `intl`, `url_launcher`, `image_picker`
- Platforms: Android, iOS, Web, Windows, macOS, Linux (Flutter multi-platform folders present)

## Requirements
- Flutter SDK (compatible with Dart SDK `^3.9.2` per `pubspec.yaml`)
- A configured Firebase project (Web/Android/iOS and optionally desktop/web as needed)
- Platform SDKs as required by Flutter for your target platforms
  - Android: Android Studio + SDK, Java 17 per current Flutter toolchain
  - iOS: Xcode (on macOS)
  - Web: A modern browser
  - Desktop: Platform toolchain per Flutter docs

Optional/Tooling:
- FlutterFire CLI for (re)generating Firebase options: `dart pub global activate flutterfire_cli`

## Project Structure
```
smart_school/
├─ lib/
│  ├─ main.dart
│  ├─ controllers/
│  │  ├─ admin_controller.dart
│  │  ├─ driver_controller.dart
│  │  └─ parent_controller.dart
│  ├─ screens/
│  │  ├─ admin_dashboard_screen.dart
│  │  ├─ assignments_screen.dart
│  │  ├─ driver_screen.dart
│  │  ├─ exam_results_screen.dart
│  │  └─ login_screen.dart
│  ├─ services/
│  │  ├─ auth_service.dart
│  │  └─ firebase_options.dart  (generated by FlutterFire)
│  ├─ widgets/                  (reusable UI widgets)
│  └─ models/                   (data models)
├─ test/
│  └─ widget_test.dart
├─ android/, ios/, web/, windows/, macos/, linux/
├─ pubspec.yaml
└─ analysis_options.yaml
```

## Setup
1) Install Flutter
- Follow the official guide: https://docs.flutter.dev/get-started/install
- Ensure `flutter --version` works and you have required platform toolchains.

2) Fetch dependencies
```
flutter pub get
```

3) Configure Firebase
- This project expects `lib/services/firebase_options.dart` to exist (it already does in this repo). If you need to reconfigure or set up a new Firebase project:
  - Install FlutterFire CLI: `dart pub global activate flutterfire_cli`
  - Run: `flutterfire configure` and select your Firebase project and platforms
  - This generates/updates `lib/services/firebase_options.dart`

4) Platform permissions (Location, Internet, etc.)
- Android: Ensure `ACCESS_COARSE_LOCATION` / `ACCESS_FINE_LOCATION` permissions are in `AndroidManifest.xml` for `geolocator`. Internet permission is usually included by default.
- iOS: Add `NSLocationWhenInUseUsageDescription` (and/or `NSLocationAlwaysAndWhenInUseUsageDescription` if needed) in `ios/Runner/Info.plist`.
- Web: Geolocation prompts are handled by the browser.

TODOs for Maintainers:
- TODO: Verify and document all Android `AndroidManifest.xml` permissions currently declared.
- TODO: Verify and document all iOS `Info.plist` keys currently declared.

## Running the App
List devices and select a target:
```
flutter devices
```
Run in debug mode on the selected device:
```
flutter run
```
Run for a specific platform/device (examples):
```
flutter run -d chrome       # Web
flutter run -d windows      # Windows desktop
flutter run -d macos        # macOS desktop
flutter run -d linux        # Linux desktop
flutter run -d emulator-5554  # Android emulator
```

Hot reload is supported in debug mode.

## Build & Release
- Android APK (debug):
```
flutter build apk
```
- Android AppBundle (release):
```
flutter build appbundle
```
- iOS (release; requires macOS/Xcode):
```
flutter build ios
```
- Web (release):
```
flutter build web
```
- Desktop (release):
```
flutter build windows | macos | linux
```

Refer to Flutter docs for signing and store deployment steps.

## Environment Variables & Configuration
- Firebase configuration is embedded via `firebase_options.dart` generated by FlutterFire. No `.env` file is used by default.
- If you need environment-specific settings beyond Firebase (e.g., API URLs), consider using Dart `const`/`--dart-define` flags, e.g.:
```
flutter run --dart-define=API_BASE_URL=https://example.com
```
- The app uses `flutter_map` (OpenStreetMap by default) and does not require a Google Maps API key. If you switch to a tiles provider that requires keys, document it here.

TODOs for Maintainers:
- TODO: List any additional environment keys if introduced (e.g., `--dart-define` values).

## Scripts
This project does not define custom CLI scripts. Common commands:
- Format: `flutter format .`
- Analyze: `flutter analyze`
- Test: `flutter test`
- Outdated deps: `flutter pub outdated`
- Upgrade deps: `flutter pub upgrade --major-versions`

## Testing
A starter widget test exists at `test/widget_test.dart`.

Run all tests:
```
flutter test
```

TODOs for Maintainers:
- TODO: Add unit tests for controllers in `lib/controllers`.
- TODO: Add integration/widget tests for major screens and Firebase flows.

## Troubleshooting
- If Firebase fails to initialize, re-run `flutterfire configure` to regenerate `firebase_options.dart` and ensure each platform has the required config files (e.g., `google-services.json` for Android, `GoogleService-Info.plist` for iOS, and web config in `web/index.html` if applicable).
- If Geolocator features fail:
  - Ensure runtime location permission is requested and granted.
  - Confirm platform permission declarations (Android/iOS) exist.
- For Windows builds, ensure Visual Studio with Desktop development with C++ workload is installed.

## License
TODO: Add a license (e.g., MIT, Apache-2.0). If unspecified, the project is proprietary by default.
